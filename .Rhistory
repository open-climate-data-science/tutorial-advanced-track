knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(rnoaa)
library(forecast)
install.packages("xts")                      # Install & load xts package
library("xts")
temp_ts <- xts(cardinal$TAvg,cardinal$date)
install.packages("xts")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(rnoaa)
library(forecast)
install.packages("xts")                      # Install & load xts package
library("xts")
temp_ts <- xts(cardinal$TAvg,cardinal$date)
cardinal <- read_csv("cardinal_data.csv",
col_types = list(`Average Air Temperature (F)` = col_number(),
`Maximum Air Temperature (F)` = col_number(),
`Minimum Air Temperature (F)` = col_number(),
`Average Experimental Leaf Wetness (mV)` = col_number(),
`Total Precipitation (in)` = col_number(),
`Average Relative Humidity (%)` = col_number(),
`Average Soil Moisture (m3/m3)` = col_number(),
`Average Soil Temperature (F)` = col_number(),
`Average Solar Radiation (W/m2)` = col_number(),
`Average Station Pressure (mb)` = col_number()))
cardinal<-drop_na(cardinal)
str(cardinal)
cardinal$Date<-as.Date(cardinal$Date, tryFormats= c("%m/%d/%y"))
view(cardinal)
#changes col names
colnames(cardinal)=c("date","AvgT","MaxT","MinT","AvgLw","Tprep","AvgHum","AvgSm","AvgSt","AvgSr","AvgStp")
cardinal$IfRain<- (cardinal$Tprep>0)
cardinal$IfRain<-as.factor(as.integer(cardinal$IfRain))
#logistic regression
fit1 = glm(IfRain~date, data=cardinal, family="binomial")
summary(fit1)
#predict something with logistic regression
temp_ts <- xts(cardinal$TAvg,cardinal$date)
class(temp_ts)
autoplot(temp_ts)
autoplot(temp_ts)
autoplot(temp_ts)
autoplot(temp_ts)
View(temp_ts)
temp_ts <- xts(cardinal$TAvg,cardinal$date)
class(temp_ts)
autoplot(temp_ts)
temp_ts <- xts(cardinal$TAvg,cardinal$date)
temp_ts
cardinal <- read_csv("cardinal_data.csv",
col_types = list(`Average Air Temperature (F)` = col_number(),
`Maximum Air Temperature (F)` = col_number(),
`Minimum Air Temperature (F)` = col_number(),
`Average Experimental Leaf Wetness (mV)` = col_number(),
`Total Precipitation (in)` = col_number(),
`Average Relative Humidity (%)` = col_number(),
`Average Soil Moisture (m3/m3)` = col_number(),
`Average Soil Temperature (F)` = col_number(),
`Average Solar Radiation (W/m2)` = col_number(),
`Average Station Pressure (mb)` = col_number()))
cardinal<-drop_na(cardinal)
str(cardinal)
cardinal$Date<-as.Date(cardinal$Date, tryFormats= c("%m/%d/%y"))
view(cardinal)
#changes col names
colnames(cardinal)=c("date","AvgT","MaxT","MinT","AvgLw","Tprep","AvgHum","AvgSm","AvgSt","AvgSr","AvgStp")
cardinal$IfRain<- (cardinal$Tprep>0)
cardinal$IfRain<-as.factor(as.integer(cardinal$IfRain))
temp_ts <- xts(cardinal$Tprep,cardinal$date)
temp_ts
temp_ts <- xts(cardinal$AvgT,cardinal$date)
temp_ts
autoplot(temp_ts)
library(forecast)
temp_ts <- xts(cardinal$AvgT,cardinal$date)
temp_ts
autoplot(temp_ts)
library(forecast)
d.arima <- auto.arima(temp_ts)
d.forecast <- forecast(d.arima, level = c(95), h = 50)
autoplot(d.forecast)
d.forecast <- forecast(d.arima, level = c(95), h = 100)
d.forecast <- forecast(d.arima, level = c(95), h = 100)
autoplot(d.forecast)
d.forecast <- forecast(d.arima, level = c(80), h = 20)
autoplot(d.forecast)
autoplot(temp_ts[1:600])
half_temp <-temp_ts[1:600]
d.arima <- auto.arima(half_temp)
d.forecast <- forecast(d.arima, level = c(80), h = 20)
autoplot(d.forecast)
d.forecast <- forecast(d.arima, level = c(80), h = 200)
autoplot(d.forecast)
d.forecast <- forecast(d.arima, level = c(40), h = 200)
autoplot(d.forecast)
d.forecast <- forecast(d.arima, level = c(90), h = 200)
autoplot(d.forecast)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(rnoaa)
library(forecast)
install.packages("xts")                      # Install & load xts package
library("xts")
cardinal
install.packages("xts")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
library(rnoaa)
library(forecast)
install.packages("xts")                      # Install & load xts package
library("xts")
cardshort <- cardinal%>%select(-c(date,IfRain,Tprep,MinT,MaxT))
install.packages("xts")
cardshort
cardshort
center(cardshort)
center[cardshort]
?center
??center
scale(cardshort,scale=FALSE)
pca_card<- princomp(scale(cardshort,scale=FALSE),cor = FALSE)
plot(pca_card$scores, pch = 16, col = as.factor(IfRain))
plot(pca_card$scores, pch = 16, col =IfRain)
pca_card<- princomp(scale(cardshort[-IfRain],scale=FALSE),cor = FALSE)
cardshort <- cardinal%>%select(-c(date,Tprep,MinT,MaxT))
cardshort
pca_card<- princomp(scale(cardshort[-IfRain],scale=FALSE),cor = FALSE)
pca_card<- princomp(scale(cardshort[,-c(IfRain)],scale=FALSE),cor = FALSE)
cardshort[,c(IfRain)]
cardshort
cardshor$IfRain
cardshorr$IfRain
cardshort$IfRain
IfRainVar<- cardinal$IfRain
cardshort <- cardinal%>%select(-c(date,IfRain.Tprep,MinT,MaxT))
cardshort <- cardinal%>%select(-c(date,IfRain,Tprep,MinT,MaxT))
cardshort
pca_card<- princomp(scale(cardshort,scale=FALSE),cor = FALSE)
plot(pca_card$scores, pch = 16, col =IfRain)
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend(0, 0.4, c("No Rain", "Rain"), pch = 16, col = c("black", "red"))
legend( c("No Rain", "Rain"), pch = 16, col = c("black", "red"))
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend( c("No Rain", "Rain"), pch = 16, col = c("black", "red"))
help(legend)
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend(150,150, c("No Rain", "Rain"), pch = 16, col = c("black", "red"))
legend(x=150,y=150, c("No Rain", "Rain"), pch = 16, col = c("black", "red"))
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend(x=150,y=150, c("No Rain", "Rain"), pch = 16, col = c("black", "red"))
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend(x=200,y=150, c("No Rain", "Rain"), pch = 16, col = c("black", "red"))
legend(200,150, c("No Rain", "Rain"), pch = 16, col = c("black", "red"))
legend(200,150,c("No Rain","Rain"),pch=16,col=c("black","red"))
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend(200,150,c("No Rain","Rain"),pch=16,col=c("black","red"))
legend(200,150,c("No Rain","Rain"),pch=10,col=c("black","red"))
legend(200,150,c("No Rain","Rain"),pch=10,col=c("black","red"))
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend(200,150,c("No Rain","Rain"),pch=10,col=c("black","red"))
legend("topright",c("No Rain","Rain"),pch=10,col=c("black","red"))
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend("topright",c("No Rain","Rain"),pch=10,col=c("black","red"))
IfRainVar<- cardinal$IfRain
cardshort <- cardinal%>%select(-c(date,IfRain,Tprep,MinT,MaxT))
cardshort
pca_card<- princomp(scale(cardshort,scale=FALSE),cor = FALSE)
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend("topright",c("No Rain","Rain"),pch=10,col=c("black","red"))
plot(pca_card$scores, pch = 10, col =IfRainVar)
legend("topright",c("No Rain","Rain"),pch=10,col=c("black","red"))
IfRainVar<- cardinal$IfRain
cardshort <- cardinal%>%select(-c(date,IfRain,Tprep,MinT,MaxT))
cardshort
pca_card<- princomp(scale(cardshort,scale=FALSE),cor = FALSE)
plot(pca_card$scores, pch = 10, col =IfRainVar)
legend("topright",c("No Rain","Rain"),pch=10,col=c("black","red"))
legend("topright",c("No Rain","Rain"),pch=16,col=c("black","red"))
IfRainVar<- cardinal$IfRain
cardshort <- cardinal%>%select(-c(date,IfRain,Tprep,MinT,MaxT))
cardshort
pca_card<- princomp(scale(cardshort,scale=FALSE),cor = FALSE)
plot(pca_card$scores, pch = 16, col =IfRainVar)
legend("topright",c("No Rain","Rain"),pch=16,col=c("black","red"))
summary(pca_card)
screeplot(pca_card, type = "lines")
loadings(pca_card)
biplot(pca_card)
